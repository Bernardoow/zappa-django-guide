<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Custom Domains - Guide to using Django with Zappa</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
	
	<script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Guide to using Django with Zappa</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Walkthroughs <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../setup/">Setup your Environment</a>
</li>
                            
<li >
    <a href="../walk_core/">Core Django Setup</a>
</li>
                            
<li >
    <a href="../walk_static/">Hosting Static Files</a>
</li>
                            
<li >
    <a href="../walk_database/">Using a Database</a>
</li>
                            
<li class="active">
    <a href="./">Custom Domains</a>
</li>
                            
<li >
    <a href="../walk_media/">Wrangling Media Files</a>
</li>
                            
<li >
    <a href="../walk_scheduling/">Tasks and Events</a>
</li>
                            
<li >
    <a href="../walk_debug/">Debugging</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">AWS Setup <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../aws_credentials/">Managing Credentials</a>
</li>
                            
<li >
    <a href="../aws_network/">Adventures in Networking</a>
</li>
                            
<li >
    <a href="../aws_database/">Creating an RDS Database</a>
</li>
                        </ul>
                    </li>
                    <li >
                        <a href="../additional/">Additional</a>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../walk_database/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../walk_media/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#using-a-custom-domain">Using a Custom Domain</a></li>
        <li class="main "><a href="#domain-name-prep">Domain Name Prep</a></li>
            <li><a href="#hosting-elsewhere">Hosting elsewhere</a></li>
            <li><a href="#hosting-on-route53">Hosting on Route53</a></li>
        <li class="main "><a href="#get-ssl-cert">Get SSL Cert</a></li>
            <li><a href="#outside">outside</a></li>
            <li><a href="#acm">ACM</a></li>
        <li class="main "><a href="#put-in-zappa-settings">put in zappa settings</a></li>
        <li class="main "><a href="#run">Run</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="using-a-custom-domain">Using a Custom Domain</h1>
<p>If you've followed the walkthroughs thus far, you've at least created a working <a href="../walk_core/">Django site using Zappa</a>
But the URL provided by Zappa is pretty darn ugly.  Not only does it use an apparent random domain name, but the Zappa environment is used as the path.  For example:</p>
<pre><code class="sh">https://bnu0zcwezd.execute-api.us-east-1.amazonaws.com/dev/
        ^^^^^^^^^^^^^^^^^^^^^^                         ^^^
      Auto Generated API Gateway              Your Zappa Environment
</code></pre>

<p>Ideally most sites would be something like:</p>
<pre><code class="sh">https://www.contoso.com/
</code></pre>

<p>This is entirely possible with Zappa - so how do we get there?</p>
<p>Notes here:</p>
<h1 id="domain-name-prep">Domain Name Prep</h1>
<h2 id="hosting-elsewhere">Hosting elsewhere</h2>
<h2 id="hosting-on-route53">Hosting on Route53</h2>
<ul>
<li>Create hosted zone</li>
</ul>
<h1 id="get-ssl-cert">Get SSL Cert</h1>
<h2 id="outside">outside</h2>
<ul>
<li>import the cert into acm</li>
<li>but you have to deal with renewals yourself
https://aws.amazon.com/certificate-manager/faqs/</li>
</ul>
<h2 id="acm">ACM</h2>
<p>do this from the east region and it will distribute
https://aws.amazon.com/certificate-manager/faqs/</p>
<ul>
<li>add domain</li>
<li>the look for email</li>
<li>verify and get the ARN</li>
</ul>
<p>good for 13 months
https://aws.amazon.com/certificate-manager/faqs/</p>
<h1 id="put-in-zappa-settings">put in zappa settings</h1>
<pre><code>    "certificate_arn": "arn:aws:acm:us-east-1:738356466015:certificate/1d066282-ce94-4ad7-a802-2ff87d32b104",
    "domain": "www.contoso.com",
</code></pre>
<h1 id="run">Run</h1>
<pre><code>zappa certify dev
</code></pre>

<p>so what happens is that zappa requests that the api gateway associate the custom domain and ssl to a new, hidden cloudfront distribution.  It's hard to figure out what the settings are on this cf distro so just roll with it.
if you are a control freak, just make your own</p>
<p>it takes some time, but now hit it</p>
<p>https://www.contoso.com</p>
<p>http://docs.aws.amazon.com/apigateway/latest/developerguide/how-to-custom-domains.html</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
        <script src="../js/base.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
